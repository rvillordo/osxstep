clean up everything
fix a few leaks
define the better design for keeping it simple but expandable
